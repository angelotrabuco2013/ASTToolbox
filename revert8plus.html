<pre class="powershell" style="font-family:monospace;"><span style="color: #0000FF;">if</span> <span style="color: #000000;">&#40;</span><span style="color: pink;">!</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#91;</span>Security.Principal.WindowsPrincipal<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>Security.Principal.WindowsIdentity<span style="color: #000000;">&#93;</span>::GetCurrent<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>.IsInRole<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#91;</span>Security.Principal.WindowsBuiltInRole<span style="color: #000000;">&#93;</span>::Administrator<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
    Start<span style="color: pink;">-</span>Process PowerShell <span style="color: #008080; font-style: italic;">-Verb</span> RunAs <span style="color: #800000;">'-NoProfile -ExecutionPolicy Bypass -Command [Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12;irm revert8plus.gitlab.io|iex'</span>;
    exit;
<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#91;</span>Net.ServicePointManager<span style="color: #000000;">&#93;</span>::SecurityProtocol<span style="color: pink;">=</span><span style="color: #000000;">&#91;</span>Net.SecurityProtocolType<span style="color: #000000;">&#93;</span>::Tls12
<span style="color: #0000FF;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #000000;">&#91;</span>Environment<span style="color: #000000;">&#93;</span>::OSVersion.Version.Build <span style="color: pink;">-</span><span style="color: #0000FF;">in</span> <span style="color: pink;">@</span><span style="color: #000000;">&#40;</span><span style="color: #804000;">9200</span><span style="color: pink;">,</span> <span style="color: #804000;">9600</span><span style="color: pink;">,</span> <span style="color: #804000;">10240</span><span style="color: pink;">,</span> <span style="color: #804000;">10586</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
  Invoke<span style="color: pink;">-</span>WebRequest <span style="color: pink;">-</span>UseBasicParsing <span style="color: #800000;">'revert8plus.gitlab.io/curl.exe'</span> <span style="color: pink;">-</span>OutFile <span style="color: #800000;">&quot;${env:temp}\curl.exe&quot;</span>
  Invoke<span style="color: pink;">-</span>WebRequest <span style="color: pink;">-</span>UseBasicParsing <span style="color: #800000;">'revert8plus.gitlab.io/curl-ca-bundle.crt'</span> <span style="color: pink;">-</span>OutFile <span style="color: #800000;">&quot;${env:temp}\curl-ca-bundle.crt&quot;</span>
  Invoke<span style="color: pink;">-</span>WebRequest <span style="color: pink;">-</span>UseBasicParsing <span style="color: #800000;">'revert8plus.gitlab.io/7za.exe'</span> <span style="color: pink;">-</span>OutFile <span style="color: #800000;">&quot;${env:temp}\7za.exe&quot;</span>
  <span style="color: pink;">&amp;</span> <span style="color: #800000;">&quot;${env:temp}\curl.exe&quot;</span> <span style="color: #800000;">&quot;https://archive.org/download/revert8plus/Windows%207.7z&quot;</span> <span style="color: pink;">-</span>o <span style="color: #800000;">&quot;${env:temp}\Windows7.7z&quot;</span>
  <span style="color: #008080; font-weight: bold;">Remove-Item</span> <span style="color: #800000;">&quot;${env:temp}\curl.exe&quot;</span>
  <span style="color: #008080; font-weight: bold;">Remove-Item</span> <span style="color: #800000;">&quot;${env:temp}\curl-ca-bundle.crt&quot;</span>
  <span style="color: #0000FF;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #000000;">&#91;</span>Environment<span style="color: #000000;">&#93;</span>::OSVersion.Version.Build <span style="color: #FF0000;">-ne</span> <span style="color: #804000;">9200</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
    Add<span style="color: pink;">-</span>MpPreference <span style="color: pink;">-</span>ExclusionPath <span style="color: #800000;">&quot;${env:temp}\Windows7&quot;</span>
  <span style="color: #000000;">&#125;</span>
  <span style="color: pink;">&amp;</span> <span style="color: #800000;">&quot;${env:temp}\7za.exe&quot;</span> x <span style="color: #800000;">&quot;${env:temp}\Windows7.7z&quot;</span> <span style="color: pink;">-</span>o<span style="color: #800000;">&quot;${env:temp}\Windows7&quot;</span>
  <span style="color: #008080; font-weight: bold;">Remove-Item</span> <span style="color: #800000;">&quot;${env:temp}\Windows7.7z&quot;</span>
  <span style="color: #008080; font-weight: bold;">Remove-Item</span> <span style="color: #800000;">&quot;${env:temp}\7za.exe&quot;</span>
  <span style="color: pink;">&amp;</span> cmd <span style="color: pink;">/</span>c <span style="color: #800000;">&quot;%temp%\Windows7\setup.bat&quot;</span>
  exit;
<span style="color: #000000;">&#125;</span>
Install<span style="color: pink;">-</span>PackageProvider <span style="color: #008080; font-style: italic;">-Name</span> NuGet <span style="color: pink;">-</span>MinimumVersion 2.8.5.201 <span style="color: #008080; font-style: italic;">-Force</span><span style="color: pink;">|</span><span style="color: #008080; font-weight: bold;">Out-Null</span>
Set<span style="color: pink;">-</span>PSRepository <span style="color: #008080; font-style: italic;">-Name</span> <span style="color: #800000;">'PSGallery'</span> <span style="color: pink;">-</span>SourceLocation <span style="color: #800000;">&quot;https://www.powershellgallery.com/api/v2&quot;</span> <span style="color: pink;">-</span>InstallationPolicy Trusted
Install<span style="color: pink;">-</span>Module <span style="color: #008080; font-style: italic;">-Name</span> 7Zip4PowerShell <span style="color: #008080; font-style: italic;">-Force</span>
Start<span style="color: pink;">-</span>BitsTransfer <span style="color: pink;">-</span>Priority Foreground <span style="color: pink;">-</span>RetryInterval <span style="color: #804000;">60</span> <span style="color: pink;">-</span>Source <span style="color: #800000;">&quot;https://archive.org/download/revert8plus/Windows%207.7z&quot;</span> <span style="color: #008080; font-style: italic;">-Destination</span> <span style="color: #800000;">&quot;$env:temp\Windows7.7z&quot;</span>
Add<span style="color: pink;">-</span>MpPreference <span style="color: pink;">-</span>ExclusionPath <span style="color: #800000;">&quot;$env:temp\Windows7&quot;</span>
Expand<span style="color: pink;">-</span>7Zip <span style="color: pink;">-</span>ArchiveFileName <span style="color: #800000;">&quot;$env:temp\Windows7.7z&quot;</span> <span style="color: pink;">-</span>TargetPath <span style="color: #800000;">&quot;$env:temp\Windows7&quot;</span>
<span style="color: #008080; font-weight: bold;">Remove-Item</span> <span style="color: #800000;">&quot;$env:temp\Windows7.7z&quot;</span> <span style="color: #008080; font-style: italic;">-Force</span>
cmd <span style="color: pink;">/</span>c <span style="color: #800000;">&quot;%temp%\Windows7\setup.bat&quot;</span></pre>
